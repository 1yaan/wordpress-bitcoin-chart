<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>WP Bitcoin Chart Example</title>

  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.6.1/css/bulma.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.19.3/moment.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.1/Chart.min.js"></script>
</head>
<body>
  <section class="section">
    <div class="container">
      <h1 class="title">WP Bitcoin Chart Example</h1>
      <p class="subtitle">
        このようなグラフが表示されるでしょう！
      </p>
      <div class="content">
        <ul>
          <li>WP Bitcoin Chartプラグインで使っているデータは、<a href="https://cryptowatch.jp/bitflyer/btcjpy" target="_blank">Cryptwatch BTC/JPY</a>を使用しています。</li>
          <li>WP Bitcoin Chartプラグインでは、<a href="http://www.chartjs.org/" target="_blank">Chartjs</a>を使用してグラフを表示します。</li>
          <li>WP Bitcoin Chartプラグインでは、10min, 30min, 60min, 1dayのデータを表示できます。表示期間の初期値は30日です。</li>
          <li>このサンプルページでは、UTC timestamp=1512054000(2017/12/01 00:00:00)時点から2017/12/06までの、1日ごとのBTC/JPYの取引について表示します。</li>
          <li>このサンプルページのスタイルは、<a href="https://bulma.io" target="_blank">BULMA (https://bulma.io)</a>を使用しています。</li>
        </ul>
      </div>
      <div class="wp-bitcoin-chart-field">
        <canvas id="myChart"></canvas>
        <div class="columns">
          <div class="column">
            <div class="buttons has-addons">
              Zoom:&nbsp;
              <a href="#" id="myChart-zoom-10min" class="button">10min</a>
              <a href="#" id="myChart-zoom-30min" class="button is-info is-selected">30min</a>
              <a href="#" id="myChart-zoom-60min" class="button">60min</a>
              <a href="#" id="myChart-zoom-1day" class="button">1day</a>
            </div>
          </div>
          <div class="column">
            From:&nbsp;<input type="text" id="myChart-from-input" value="2017-11-30">&nbsp;To:&nbsp;<input type="text" id="myChart-to-input" value="2017-12-06">
          </div>
        </div>
      </div>
    </div>
  </section>

  <script>
  var ctx = document.getElementById('myChart').getContext('2d');
  // https://api.cryptowat.ch/markets/bitflyer/btcjpy/ohlc?periods=86400&after=1512054000
  // {"result":{"86400":[[1512000000,1141802,1317140,980000,1134017,42518.234],[1512086400,1134017,1273402,1035001,1174880,33419.438],[1512172800,1171219,1239711,1094900,1235998,21826.799],[1512259200,1235995,1255000,1207719,1232714,16287.729],[1512345600,1230501,1327536,1218253,1282000,18746.816],[1512432000,1282000,1308000,1250001,1303906,14576.17],[1512518400,1303500,1306000,1292000,1297593,2391.8408]]},"allowance":{"cost":1180428,"remaining":7996635637}}
  // [ CloseTime, OpenPrice, HighPrice, LowPrice, ClosePrice, Volume ]
  // http://url-c.com/tc/ UNIX timestamp変換

  var openPriceData  = [1141802,1134017,1171219,1235995,1230501,1282000,1303500];
  var highPriceData  = [1317140,1273402,1239711,1255000,1327536,1308000,1306000];
  var lowPriceData   = [ 980000,1035001,1094900,1207719,1218253,1250001,1292000];
  var closePriceData = [1134017,1174880,1235998,1232714,1282000,1303906,1297593];
  var volumeData     = [42518.234,33419.438,21826.799,16287.729,18746.816,14576.17,3385.9707]

  var formatS = "MM/DD";

  var chart = new Chart(ctx, {
      type: 'line',
      data: {
        labels: [
          moment.unix(1512000000).format(formatS),
          moment.unix(1512086400).format(formatS),
          moment.unix(1512172800).format(formatS),
          moment.unix(1512259200).format(formatS),
          moment.unix(1512345600).format(formatS),
          moment.unix(1512432000).format(formatS),
          moment.unix(1512518400).format(formatS)
        ], // 選択された期間とする [10min、30min、60min、1day]
        datasets: [
          {
            label: "Open Price",
            borderColor: 'rgb(255, 255, 0)', // 可変とする
            data: openPriceData, // 選択された期間分のデータを表示する
            drawBorder: false,
          },
          {
            label: "High Price",
            borderColor: 'rgb(255, 0, 0)', // 可変とする
            data: highPriceData, // 選択された期間分のデータを表示する
          },
          {
            label: "Low Price",
            borderColor: 'rgb(0, 0, 255)', // 可変とする
            data: lowPriceData, // 選択された期間分のデータを表示する
          },
          {
            label: "Close Price",
            borderColor: 'rgb(0, 255, 0)', // 可変とする
            data: closePriceData, // 選択された期間分のデータを表示する
          },
          {
            label: "Volume",
            borderColor: 'rgb(255, 0, 255)', // 可変とする
            data: volumeData, // 選択された期間分のデータを表示する
          },
        ]
      },
      options: {
        title: {
          display: true,
          text: "BTC/JPY"
        }
      }
  });
  </script>
</body>
</html>
